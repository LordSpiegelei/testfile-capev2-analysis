import win32file
import win32con
from abc import ABC, abstractmethod

class GenericAction(ABC):

    def __init__(self):
        pass

    @abstractmethod
    def run(self, *args, **kwargs) -> None:
        raise NotImplementedError
    


class Action(GenericAction):

    def write_file(self, path, content: str | bytes):
        handle = win32file.CreateFile(
            path,
            win32con.GENERIC_WRITE,
            0,
            None,
            win32con.CREATE_ALWAYS,
            0,
            None
        )
        if isinstance(content, str):
            win32file.WriteFile(handle, content.encode("utf-8"))
        else:
            win32file.WriteFile(handle, content)
        win32file.CloseHandle(handle)
    